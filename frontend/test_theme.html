<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Theme Toggle Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            margin: 0;
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .pass {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .fail {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .test-info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>Theme Toggle Implementation Test</h1>
    <div id="test-results"></div>
    
    <script>
        async function runTests() {
            const results = [];
            
            // Test 1: Check if theme toggle button exists in the main app
            try {
                const response = await fetch('/');
                const html = await response.text();
                
                const hasThemeToggle = html.includes('id="themeToggle"');
                const hasThemeIcons = html.includes('theme-icon sun') && html.includes('theme-icon moon');
                const hasThemeToggleClass = html.includes('class="theme-toggle"');
                
                results.push({
                    test: "Theme Toggle Button HTML",
                    passed: hasThemeToggle && hasThemeIcons && hasThemeToggleClass,
                    details: `Button exists: ${hasThemeToggle}, Icons exist: ${hasThemeIcons}, CSS class exists: ${hasThemeToggleClass}`
                });
                
            } catch (error) {
                results.push({
                    test: "Theme Toggle Button HTML",
                    passed: false,
                    details: `Error fetching HTML: ${error.message}`
                });
            }
            
            // Test 2: Check if CSS contains theme variables
            try {
                const response = await fetch('/style.css');
                const css = await response.text();
                
                const hasLightTheme = css.includes('[data-theme="light"]');
                const hasDarkTheme = css.includes(':root {') && css.includes('--background');
                const hasThemeToggleStyles = css.includes('.theme-toggle');
                const hasTransitions = css.includes('transition:');
                
                results.push({
                    test: "CSS Theme System",
                    passed: hasLightTheme && hasDarkTheme && hasThemeToggleStyles && hasTransitions,
                    details: `Light theme: ${hasLightTheme}, Dark theme: ${hasDarkTheme}, Toggle styles: ${hasThemeToggleStyles}, Transitions: ${hasTransitions}`
                });
                
            } catch (error) {
                results.push({
                    test: "CSS Theme System",
                    passed: false,
                    details: `Error fetching CSS: ${error.message}`
                });
            }
            
            // Test 3: Check if JavaScript contains theme functions
            try {
                const response = await fetch('/script.js');
                const js = await response.text();
                
                const hasToggleTheme = js.includes('function toggleTheme()');
                const hasSetTheme = js.includes('function setTheme(');
                const hasInitializeTheme = js.includes('function initializeTheme()');
                const hasLocalStorage = js.includes('localStorage.getItem') && js.includes('localStorage.setItem');
                const hasEventListener = js.includes('themeToggle.addEventListener');
                
                results.push({
                    test: "JavaScript Theme Functions",
                    passed: hasToggleTheme && hasSetTheme && hasInitializeTheme && hasLocalStorage && hasEventListener,
                    details: `Toggle function: ${hasToggleTheme}, Set function: ${hasSetTheme}, Init function: ${hasInitializeTheme}, LocalStorage: ${hasLocalStorage}, Event listener: ${hasEventListener}`
                });
                
            } catch (error) {
                results.push({
                    test: "JavaScript Theme Functions",
                    passed: false,
                    details: `Error fetching JS: ${error.message}`
                });
            }
            
            // Display results
            const resultsDiv = document.getElementById('test-results');
            let html = '';
            
            results.forEach(result => {
                const className = result.passed ? 'pass' : 'fail';
                const status = result.passed ? 'PASS' : 'FAIL';
                html += `
                    <div class="test-result ${className}">
                        ${status}: ${result.test}
                    </div>
                    <div class="test-info">
                        ${result.details}
                    </div>
                `;
            });
            
            const passedTests = results.filter(r => r.passed).length;
            const totalTests = results.length;
            
            html += `
                <div style="margin-top: 20px; padding: 15px; background-color: ${passedTests === totalTests ? '#d4edda' : '#fff3cd'}; border-radius: 4px;">
                    <strong>Test Summary: ${passedTests}/${totalTests} tests passed</strong>
                </div>
            `;
            
            if (passedTests === totalTests) {
                html += `
                    <div style="margin-top: 10px; padding: 15px; background-color: #d1ecf1; border-radius: 4px;">
                        ðŸŽ‰ <strong>Theme Toggle Implementation Complete!</strong><br>
                        â€¢ Button positioned in top-right header<br>
                        â€¢ Sun/Moon icons with smooth transitions<br>
                        â€¢ Complete light/dark theme system<br>
                        â€¢ Persistent theme preference<br>
                        â€¢ Keyboard accessibility support
                    </div>
                `;
            }
            
            resultsDiv.innerHTML = html;
        }
        
        // Run tests when page loads
        runTests();
    </script>
</body>
</html>